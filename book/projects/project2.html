
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Project 2 &#8212; FYS3150/FYS4150 course material</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8e5499552300ddf5d7adccae7cc3b70.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Project 1" href="project1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      <h1 class="site-logo" id="site-title">FYS3150/FYS4150 course material</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting ready
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_ready/windows_users.html">
   Windows users
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_ready/mac_users.html">
   Mac users
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_ready/linux_users.html">
   Linux users
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Using the terminal
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../using_the_terminal/basics.html">
   Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_the_terminal/keyboard_shortcuts.html">
   Keyboard shortcuts
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Using git and GitHub
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/introduction_to_git.html">
   Introduction to git
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/setting_up_git_and_a_GitHub_repo.html">
   Setting up git and GitHub repo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/add_a_README.html">
   Add a README
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/using_git.html">
   Using git
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/dealing_with_merge_conflicts.html">
   Dealing with merge conflicts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/recover_an_old_version_of_a_file.html">
   Recover an old version of a file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/other_ways_to_fix_mistakes.html">
   Other ways to fix mistakes
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction to C++
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/intro.html">
   Intro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/hello_world.html">
   Hello World
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/compiling_and_linking_take_1.html">
   Compiling and linking, take 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/source_files_and_header_files.html">
   Source files and header files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/variables.html">
   Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/functions_take_1.html">
   Functions, take 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/read_command_line_input.html">
   Read command line input
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/write_to_file.html">
   Write to file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/if_else.html">
   If else
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/loops.html">
   Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/containers.html">
   Containers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/intro_to_armadillo.html">
   Introduction to Armadillo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/pointers.html">
   Pointers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/classes.html">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/online_resources.html">
   Online C++ resources
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Optimization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../optimization/memory_is_the_bottleneck.html">
   Memory traffic is the bottleneck
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Parallelization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../parallelization/introduction_to_openmp.html">
   Introduction to OpenMP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../parallelization/using_openmp.html">
   Using OpenMP
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Using Make
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../using_make/intro.html">
   Intro
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Writing reports
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../writing_reports/introduction_to_latex.html">
   Introduction to LaTeX
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Projects
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="project1.html">
   Project 1
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Project 2
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/book/projects/project2.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/anderkve/FYS3150"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/anderkve/FYS3150/issues/new?title=Issue%20on%20page%20%2Fbook/projects/project2.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practicalities">
   Practicalities
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problems">
   Problems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-1">
     Problem 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-2">
     Problem 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3">
     Problem 3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-4">
     Problem 4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-5">
     Problem 5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-6">
     Problem 6
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-7">
     Problem 7
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-8-if-you-have-time">
     Problem 8 (if you have time)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code-snippets">
   Code snippets
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="project-2">
<h1>Project 2<a class="headerlink" href="#project-2" title="Permalink to this headline">¶</a></h1>
<div class="section" id="practicalities">
<h2>Practicalities<a class="headerlink" href="#practicalities" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Deadline</strong>: Monday, September 27, 23:59.</p></li>
<li><p><strong>Format:</strong></p>
<ul>
<li><p>A pdf document, typeset in LaTeX, with answers to all the problems below. You deliver the pdf on Canvas.</p></li>
<li><p>Code (with comments, of course) on a GitHub repo, with the repo link provided in the pdf documentet.</p></li>
<li><p>You <em>must</em> deliver via your group on Canvas (even if you are working alone).</p></li>
</ul>
</li>
<li><p><strong>Not a complete report:</strong> For project 2 we do not require you to write a proper scientific report — only a document with an answer for each problem. But the quality of the presentation still matters, of course. So pay attention to figures, figure captions, grammar, etc.</p></li>
<li><p><strong>Collaboration:</strong> We <em>strongly</em> encourage you to collaborate with others, in groups up to four students. The group hands in a single pdf. Remember to list everyone’s name in the pdf.</p></li>
<li><p><strong>Reproducibility:</strong> Your code should be available on a GitHub repo. You can refer to relevant parts of your code in your answers. Make sure to include a README file in the repo that briefly explains how the code is organized, and how it should be compiled and run in order to reproduce your results.</p></li>
<li><p><strong>Figures:</strong> Figures included in your LaTeX document should be made as vector graphics (e.g. <code class="docutils literal notranslate"><span class="pre">.pdf</span></code> files), rather than raster graphics (e.g. <code class="docutils literal notranslate"><span class="pre">.png</span></code> files). If you are making plots with <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> in Python, this is as simple as calling <code class="docutils literal notranslate"><span class="pre">plt.savefig(&quot;figure.pdf&quot;)</span></code> rather than <code class="docutils literal notranslate"><span class="pre">plt.savefig(&quot;figure.png&quot;)</span></code>.</p></li>
<li><p><strong>We recommend using Armadillo:</strong> For this project we recommend using Armadillo to work with matrices and vectors.</p></li>
</ul>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The main topics of this project are</p>
<ul class="simple">
<li><p>scaling of equations</p></li>
<li><p>eigenvalue problems</p></li>
<li><p>code testing (<em>unit testing</em>).</p></li>
</ul>
<p>Our example of an eigenvalue problem is a special case of a one-dimensional buckling beam. Consider the following situation:</p>
<ul class="simple">
<li><p>A horizontal beam of length <span class="math notranslate nohighlight">\(L\)</span>.</p></li>
<li><p>We let <span class="math notranslate nohighlight">\(u(x)\)</span> be the vertical displacement of the beam at horizontal position <span class="math notranslate nohighlight">\(x\)</span>, with <span class="math notranslate nohighlight">\(x \in [0,L]\)</span>.</p></li>
<li><p>A force <span class="math notranslate nohighlight">\(F\)</span> is applied at the endpoint (<span class="math notranslate nohighlight">\(x=L\)</span>), <em>directed into the beam</em>, i.e. towards <span class="math notranslate nohighlight">\(x=0\)</span>.</p></li>
<li><p>The beam is fastened with <em>pin endpoints</em>, meaning that <span class="math notranslate nohighlight">\(u(0)=0\)</span> and <span class="math notranslate nohighlight">\(u(L)=0\)</span>, but the endpoints are allowed to rotate (<span class="math notranslate nohighlight">\(u'(x) \neq 0\)</span>).</p></li>
<li><p>We are <em>not</em> studying a time-dependent system here – we are simply interested in the different static shapes the beam can take due to the applied force.</p></li>
</ul>
<p>We can then describe this situation with the second-order differential equation</p>
<div class="math notranslate nohighlight" id="equation-bb-eq-1">
<span class="eqno">(4)<a class="headerlink" href="#equation-bb-eq-1" title="Permalink to this equation">¶</a></span>\[ 
\gamma \frac{d^2 u(x)}{dx^2} = - F u(x),
\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma\)</span> is some constant defined by material properties like rigidity. However, the equation we will actually be working with is the scaled equation</p>
<div class="math notranslate nohighlight" id="equation-bb-eq-2">
<span class="eqno">(5)<a class="headerlink" href="#equation-bb-eq-2" title="Permalink to this equation">¶</a></span>\[ 
\frac{d^2 u(\hat{x})}{d\hat{x}^2} = - \lambda u(\hat{x}),
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{x} \equiv x/L\)</span> is a dimensionless (unitless) varible, <span class="math notranslate nohighlight">\(\hat{x} \in [0,1]\)</span>, and <span class="math notranslate nohighlight">\(\lambda = \frac{F L^2}{\gamma}\)</span>. (See problem 1.)</p>
<hr class="docutils" />
<p><strong>Discretization:</strong> We discretize this by dividing our <span class="math notranslate nohighlight">\(\hat{x}\)</span> range into <span class="math notranslate nohighlight">\(n\)</span> parts, i.e. we will have <span class="math notranslate nohighlight">\(n+1\)</span> points <span class="math notranslate nohighlight">\(\hat{x}_0\)</span>, <span class="math notranslate nohighlight">\(\hat{x}_1\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span>, <span class="math notranslate nohighlight">\(\hat{x}_{n-1}\)</span>, <span class="math notranslate nohighlight">\(\hat{x}_{n}\)</span>. Thus we have a stepsize</p>
<div class="math notranslate nohighlight">
\[
h = \frac{\hat{x}_{\text{max}} - \hat{x}_{\text{min}}}{n} = \frac{1 - 0}{n} = \frac{1}{n}
\]</div>
<p>and our <span class="math notranslate nohighlight">\(\hat{x}_i\)</span> points are given by</p>
<div class="math notranslate nohighlight">
\[
\hat{x}_i = \hat{x}_0 + ih, \quad i=0,1,\ldots,n.
\]</div>
<p>From this dicretization we get the following set of equations for <span class="math notranslate nohighlight">\(v_i\)</span> (our approximations to the exact <span class="math notranslate nohighlight">\(u_i\)</span>):</p>
<div class="math notranslate nohighlight">
\[
\frac{-v_{i+1} + 2v_i -v_{i-1}}{h^2} = \lambda v_i.
\]</div>
<p>By inserting the boundary conditions <span class="math notranslate nohighlight">\(v_0=0\)</span> and <span class="math notranslate nohighlight">\(v_n=0\)</span> we can write this as the linear algebra eigenvalue problem</p>
<div class="math notranslate nohighlight" id="equation-bb-eq-3">
<span class="eqno">(6)<a class="headerlink" href="#equation-bb-eq-3" title="Permalink to this equation">¶</a></span>\[
\mathbf{A} \vec{v} = \lambda \vec{v}
\]</div>
<p>where</p>
<ul class="simple">
<li><p>the elements of the vector <span class="math notranslate nohighlight">\(\vec{v}\)</span> are <span class="math notranslate nohighlight">\(\vec{v} = [v_1, \ldots, v_{n-1}]\)</span>; and</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is tridiag(<span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(a\)</span>), with</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(a = -1/h^2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(d = 2/h^2\)</span></p></li>
</ul>
</li>
<li><p><em>Note:</em> In contrast to project 1, we here keep the factor <span class="math notranslate nohighlight">\(1/h^2\)</span> as part of the definition of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p></li>
</ul>
<p>To solve this matrix equation means finding the pairs of eigenvalues and eigenvectors, (<span class="math notranslate nohighlight">\(\lambda^{(i)}, \vec{v}^{(i)}\)</span>), that satify Eq. <a class="reference internal" href="#equation-bb-eq-3">(6)</a>. These eigenvectors are then our discretized approximations to the true <em>eigenfunctions</em> <span class="math notranslate nohighlight">\(u^{(i)}(\hat{x})\)</span> that are the solutions of the differential equation in Eq. <a class="reference internal" href="#equation-bb-eq-2">(5)</a>.</p>
<hr class="docutils" />
<p><strong>Notation:</strong> We will use <span class="math notranslate nohighlight">\(N\)</span> to denote the size of the matrix, so that <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is an <span class="math notranslate nohighlight">\(N \times N\)</span> matrix, and <span class="math notranslate nohighlight">\(\vec{v}\)</span> a column vector of length <span class="math notranslate nohighlight">\(N\)</span>. Make sure not to confuse <span class="math notranslate nohighlight">\(N\)</span> with the number of <em>steps</em> in our discretization of <span class="math notranslate nohighlight">\(\hat{x}\)</span> (<span class="math notranslate nohighlight">\(n\)</span> steps), or the number of <span class="math notranslate nohighlight">\(\hat{x}_i\)</span> points (<span class="math notranslate nohighlight">\(n+1\)</span> points). They are related as <span class="math notranslate nohighlight">\(N = n-1\)</span>.</p>
<hr class="docutils" />
<p><strong>Analytical solutions:</strong> For a given matrix size <span class="math notranslate nohighlight">\(N \times N\)</span>, the eigenvalue problem in Eq. <a class="reference internal" href="#equation-bb-eq-3">(6)</a> with the tridiagonal matrix <span class="math notranslate nohighlight">\(\mathbf{A} = \text{tridiag}(a,d,a)\)</span> has the following set of analytical eigenvalues and eigenvectors:</p>
<div class="math notranslate nohighlight">
\[
\lambda^{(i)} = d + 2 a \cos\left(\frac{i \pi}{N+1}\right), \quad i = 1,\ldots,N
\]</div>
<div class="math notranslate nohighlight">
\[
\vec{v}^{(i)} = \left[\sin\left(\frac{i \pi}{N+1}\right), \sin\left(\frac{2 i \pi}{N+1}\right), \ldots, \sin\left(\frac{N i \pi}{N+1}\right)\right]^T,\quad i = 1,\ldots,N
\]</div>
<hr class="docutils" />
<p><strong>Scaling of eigenvectors:</strong> Remember that if <span class="math notranslate nohighlight">\(\vec{v}\)</span> is an eigenvector of <span class="math notranslate nohighlight">\(\mathbf{A} \vec{v} = \lambda \vec{v}\)</span>, then a scaled vector <span class="math notranslate nohighlight">\(c \vec{v}\)</span> (where <span class="math notranslate nohighlight">\(c\)</span> is some constant) is an equally good eigenvector. When presenting your results, and when comparing to results from Armadillo, it will be useful to scale each eigenvector to have unit norm (i.e. vector length 1). You can do this easily using the Armadillo function <code class="docutils literal notranslate"><span class="pre">arma::normalise</span></code> described <a class="reference external" href="http://arma.sourceforge.net/docs.html#normalise">here</a>.</p>
</div>
<div class="section" id="problems">
<h2>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problem-1">
<h3>Problem 1<a class="headerlink" href="#problem-1" title="Permalink to this headline">¶</a></h3>
<p>With the definition <span class="math notranslate nohighlight">\(\hat{x} \equiv x/L\)</span>, show that Eq. <a class="reference internal" href="#equation-bb-eq-1">(4)</a> can be written as Eq. <a class="reference internal" href="#equation-bb-eq-2">(5)</a>.</p>
</div>
<div class="section" id="problem-2">
<h3>Problem 2<a class="headerlink" href="#problem-2" title="Permalink to this headline">¶</a></h3>
<p>Jacobi’s rotation algorithm is based on an important property of orthogonal transformations that we will show here. Assume that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\vec{v}_i\)</span> is a set of <em>orthonormal</em> basis vectors, i.e. that <span class="math notranslate nohighlight">\(\vec{v}_i^T \cdot \vec{v}_j = \delta_{ij}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{U}\)</span> is an <em>orthogonal</em> transformation matrix, i.e. that <span class="math notranslate nohighlight">\(\mathbf{U}^T = \mathbf{U}^{-1}\)</span>.</p></li>
</ul>
<p>Show that transformations with <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> preserves orthonormality, i.e. show that the set of vectors <span class="math notranslate nohighlight">\(\vec{w}_i = \mathbf{U} \vec{v}_i\)</span> is also an orthonormal set.</p>
</div>
<div class="section" id="problem-3">
<h3>Problem 3<a class="headerlink" href="#problem-3" title="Permalink to this headline">¶</a></h3>
<p>Before we get started with implementing the Jacobi rotation algorithm, let’s make sure that we can set up the tridiagonal matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> correctly. So, write a short program that:</p>
<ul class="simple">
<li><p>sets up the tridiagonal <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> for <span class="math notranslate nohighlight">\(N=6\)</span>;</p></li>
<li><p>solves <span class="math notranslate nohighlight">\(\mathbf{A} \vec{v} = \lambda \vec{v}\)</span> using Armadillo’s <code class="docutils literal notranslate"><span class="pre">arma::eig_sym</span></code>, described <a class="reference external" href="http://arma.sourceforge.net/docs.html#eig_sym">here</a>;</p></li>
<li><p>checks that the eigenvalues and eigenvectors from Armadillo agrees with the analytical result for <span class="math notranslate nohighlight">\(N=6\)</span>. (Remember scaling of eigenvectors, as discussed above.)</p></li>
</ul>
</div>
<div class="section" id="problem-4">
<h3>Problem 4<a class="headerlink" href="#problem-4" title="Permalink to this headline">¶</a></h3>
<p>An important part of the Jacobi algorithm is to have a function that can identify the largest (in absolute value) off-diagonal element of a matrix. Here we specialize to the case of a <em>symmetric</em> matrix.</p>
<p><strong>a)</strong> Write a C++ function that can identify the largest off-diagonal element of a matrix. A suggestion is to write a function that</p>
<ul class="simple">
<li><p>has return type <code class="docutils literal notranslate"><span class="pre">double</span></code></p></li>
<li><p>takes an Armadillo matrix as input</p></li>
<li><p>takes <em>references</em> to two integers as input</p></li>
<li><p>identifies the largest off-diagonal element in the matrix (under the assumption of a symmetric matrix)</p></li>
<li><p>writes the matrix indices for this element to the two integer references</p></li>
<li><p>returns the value of this matrix element</p></li>
</ul>
<p>A simple function signature could then be</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span> <span class="n">max_offdiag_symmetric</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">mat</span> <span class="n">A</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">),</span>
</pre></div>
</div>
<p>Or, to avoid copying the (potentially large) matrix A every time we run the function, we could simply pass in a reference to A. Since the function <code class="docutils literal notranslate"><span class="pre">max_offdiag_symmetric</span></code> won’t be modifying the matrix in any way, we should make this explicit by using a <code class="docutils literal notranslate"><span class="pre">const</span></code> reference, like this:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span> <span class="n">max_offdiag_symmetric</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">mat</span><span class="o">&amp;</span> <span class="n">A</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>b)</strong> Write a small test code that tests the above function using the matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = 
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0.5\\
0 &amp; 1 &amp; -0.7 &amp; 0\\
0 &amp; -0.7 &amp; 1 &amp; 0\\
0.5 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\end{split}\]</div>
</div>
<div class="section" id="problem-5">
<h3>Problem 5<a class="headerlink" href="#problem-5" title="Permalink to this headline">¶</a></h3>
<p><strong>a)</strong> Write a code implementation of Jacobi’s rotation algorithm for solving Eq. <a class="reference internal" href="#equation-bb-eq-3">(6)</a>. See the code snippets at the end of this page for a suggested code structure.</p>
<p><strong>b)</strong> Let <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> be of size <span class="math notranslate nohighlight">\(6 \times 6\)</span>. Test your code by checking that the eigenvalues and eigenvectors you get agree with the analytical results for <span class="math notranslate nohighlight">\(N=6\)</span>.</p>
</div>
<div class="section" id="problem-6">
<h3>Problem 6<a class="headerlink" href="#problem-6" title="Permalink to this headline">¶</a></h3>
<p>Now let’s look at how many similarity transformations we need before we reach a result where all non-diagonal matrix elements are close to zero.</p>
<p><strong>a)</strong> Try to estimate how the number of required transformations scale with the matrix size <span class="math notranslate nohighlight">\(N\)</span> for your code when solving Eq. <a class="reference internal" href="#equation-bb-eq-3">(6)</a>. Present your scaling data either in a table or a plot (or both).</p>
<p><strong>b)</strong> What scaling behaviour would you expect to see if <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> was a dense matrix?</p>
</div>
<div class="section" id="problem-7">
<h3>Problem 7<a class="headerlink" href="#problem-7" title="Permalink to this headline">¶</a></h3>
<p><strong>a)</strong> For a discretization of <span class="math notranslate nohighlight">\(\hat{x}\)</span> with <span class="math notranslate nohighlight">\(n=10\)</span> steps, solve Eq. <a class="reference internal" href="#equation-bb-eq-3">(6)</a> using your Jacobi code and make a plot of the three eigenvectors corresponding to the three lowest eigenvalues. The plot should show vector elements <span class="math notranslate nohighlight">\(v_i\)</span> against the corresponding positions <span class="math notranslate nohighlight">\(\hat{x}_i\)</span>.</p>
<p>Since we are effectively showing the solutions to a differential equation, your plot should also include the boundary points <span class="math notranslate nohighlight">\((\hat{x}_0, v_0)\)</span> and <span class="math notranslate nohighlight">\((\hat{x}_n, v_n)\)</span>.</p>
<p>Plot the corresponding analytical eigenvectors (extended with the boundary points) in the same plot.</p>
<p><strong>b)</strong> Make the same plot for discretization of <span class="math notranslate nohighlight">\(\hat{x}\)</span> with <span class="math notranslate nohighlight">\(n=100\)</span> steps.</p>
</div>
<div class="section" id="problem-8-if-you-have-time">
<h3>Problem 8 (if you have time)<a class="headerlink" href="#problem-8-if-you-have-time" title="Permalink to this headline">¶</a></h3>
<p><em>Will add a bonus challenge here</em></p>
</div>
</div>
<div class="section" id="code-snippets">
<h2>Code snippets<a class="headerlink" href="#code-snippets" title="Permalink to this headline">¶</a></h2>
<p>Here is one possible sketch for the function <code class="docutils literal notranslate"><span class="pre">max_offdiag_symmetric</span></code> discussed above:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// A function that finds the max off-diag element of a symmetric matrix A.</span>
<span class="c1">// - The matrix indices of the max element are returned by writing to the  </span>
<span class="c1">//   int references k and l (row and column, respectively)</span>
<span class="c1">// - The value of the max element A(k,l) is returned as the function</span>
<span class="c1">//   return value</span>
<span class="kt">double</span> <span class="nf">max_offdiag_symmetric</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">mat</span><span class="o">&amp;</span> <span class="n">A</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">k</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Get size of the matrix A. Use e.g. A.n_rows, see the Armadillo documentation</span>

  <span class="c1">// Possible consistency checks:</span>
  <span class="c1">// Check that A is square and larger than 1x1. Here you can for instance use A.is_square(), </span>
  <span class="c1">// see the Armadillo documentation.</span>
  <span class="c1">// </span>
  <span class="c1">// The standard function &#39;assert&#39; from &lt;assert.h&gt; can be useful for quick checks like this </span>
  <span class="c1">// during the code development phase. Use it like this: assert(some condition),</span>
  <span class="c1">// e.g assert(a==b). If the condition evaluates to false, the program is killed with </span>
  <span class="c1">// an assertion error. More info: https://www.cplusplus.com/reference/cassert/assert/</span>

  <span class="c1">// Initialize references k and l to the first off-diagonal element of A</span>

  <span class="c1">// Initialize a double variable &#39;maxval&#39; to A(k,l). We&#39;ll use this variable </span>
  <span class="c1">// to keep track of the largest off-diag element.</span>

  <span class="c1">// Loop through all elements in the upper triangle of A (not including the diagonal)</span>
  <span class="c1">// When encountering a matrix element with larger absolute value than the current value of maxval,</span>
  <span class="c1">// update k, l and max accordingly.</span>

  <span class="c1">// Return maxval </span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that this function has some inefficiencies: In an optimized program, you don’t want this
function to always check that A is square and larger than 1x1 – perhaps you don’t want this
function to check this at all, but rather just trust the input is is given from your main code.
But during development, it is often useful to first write code that is fairly self-contained and “safe”
(makes it easier to debug), and then optimize it afterwards.</p>
<hr class="docutils" />
<p><strong>Watch this space for more code examples…</strong></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./book/projects"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="project1.html" title="previous page">Project 1</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By the FYS3150 teaching team<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>